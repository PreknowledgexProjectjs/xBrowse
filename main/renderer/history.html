<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>History</title>
	<link rel="stylesheet" href="./css/bsss.css" media="all">
    <link rel="stylesheet" type="text/css" href="./css/toastr.css">
    <style type="text/css">
    	a{
    		word-wrap: break-word;
    	}
    </style>
</head>
<body>
<div class="card">
  <div class="card-body" style="height: 520px;">
    <h3 align="center"><lang id="xbrowse_configuration"></lang></h3>
    <div id="extra">
      <div class="d-flex align-items-start">
        <div class="nav flex-column nav-pills me-3" id="v-pills-tab" role="tablist" aria-orientation="vertical">
          <button class="nav-link active" id="v-pills-home-tab" data-bs-toggle="pill" data-bs-target="#v-pills-home" type="button" role="tab" aria-controls="v-pills-home" aria-selected="true">History</button>
          <button class="nav-link" id="v-pills-profile-tab" data-bs-toggle="pill" data-bs-target="#v-pills-profile" type="button" role="tab" aria-controls="v-pills-profile" aria-selected="false">Settings & More</button>
          <!-- <button class="nav-link" id="v-pills-messages-tab" data-bs-toggle="pill" data-bs-target="#v-pills-messages" type="button" role="tab" aria-controls="v-pills-messages" aria-selected="false">Messages</button>
          <button class="nav-link" id="v-pills-settings-tab" data-bs-toggle="pill" data-bs-target="#v-pills-settings" type="button" role="tab" aria-controls="v-pills-settings" aria-selected="false">Settings</button> -->

        </div>
        <div class="tab-content" id="v-pills-tabContent">
          <div class="tab-pane fade show active" id="v-pills-home" role="tabpanel" aria-labelledby="v-pills-home-tab">
            <div class="table-resposnsive" style="width:700px; height:480px; overflow: auto;">
			  <table class="table">
			    <thead>
			    	<th> Time </th>
			    	<th> Url </th>
			    </thead>
			    <tbody id="history">
			    	
			    </tbody>
			  </table>
			</div>
          </div>
          <div class="tab-pane fade" id="v-pills-profile" role="tabpanel" aria-labelledby="v-pills-profile-tab">
            <button class="btn btn-danger" onclick="clearHist()"> Clear History (You'll lost history)</button>
          </div>
          <div class="tab-pane fade" id="v-pills-messages" role="tabpanel" aria-labelledby="v-pills-messages-tab">...</div>
          <div class="tab-pane fade" id="v-pills-settings" role="tabpanel" aria-labelledby="v-pills-settings-tab">
           
          </div>
          
        </div>
     </div>
</div>

<script type="text/javascript" src="./js/ajaxjs.js"></script>
<script type="text/javascript" src="./js/bundle.js"></script>
<script type="text/javascript" src="./js/toastr.js"></script>
<script src="./js/socket.io.js"></script>
<script type="text/javascript">
  //preload inputs
  let url = new URL(window.location.href)
  let params = new URLSearchParams(url.search);
  var lang = JSON.parse(url.searchParams.get("lang"));
  //socket.io
  var socket = io.connect('http://localhost:'+params.get('port'),{secure: true,rejectUnauthorized: false});
  socket.on('connect',function(){
  	toastr.success("Fetching");
  	socket.emit('get_history');
  	socket.on('history_res', function(data) {
  		$.each(data, function(index, value) {
  			$('table > tbody:last-child').append('<tr><td>'+value.date.hours+':'+value.date.minutes+'</td>'+'<td>'+'<a href="'+value.url+'">'+value.url+'</a></td></tr>');
    		console.log(`Index:${index}\nValue:${value}`);
  		});
  	});
  });
  function clearHist(){
  	socket.emit('get_history');
  	socket.emit('clear_history');
  }
</script>
</body>
</html>